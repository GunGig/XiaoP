<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€ç»ˆç« ï¼šæ•´åˆæ‰€æœ‰åŠŸèƒ½åˆ° mian.py</title>
    <style>
        /* CSS Reset and Basic Styles */
        body, h1, h2, h3, h4, p, pre, code, ul, li, div {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            line-height: 1.8;
            background-color: #f0f2f5;
            color: #333;
            padding: 20px;
        }

        /* Main Container */
        .container {
            max-width: 900px;
            margin: 20px auto;
            background-color: #ffffff;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            padding: 30px 40px;
            border: 1px solid #e8e8e8;
        }

        /* Headings */
        h1 {
            color: #2c3e50;
            font-size: 2.4em;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .intro {
            font-size: 1.1em;
            color: #555;
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 2px solid #8e44ad;
            padding-bottom: 20px;
        }

        /* Level Card Style */
        .level-card {
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            transition: all 0.3s ease-in-out;
            border-left: 5px solid #8e44ad;
        }

        .level-card h2 {
            color: #8e44ad;
            font-size: 2em;
            margin-bottom: 20px;
        }
        
        h3 {
            color: #16a085;
            margin-top: 25px;
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        .objective {
            font-style: italic;
            color: #7f8c8d;
            margin-bottom: 20px;
            padding: 10px 15px;
            background: #ecf0f1;
            border-radius: 6px;
            border-left: 3px solid #7f8c8d;
        }

        /* Code Blocks */
        pre {
            background-color: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            line-height: 1.6;
        }
        pre code {
            font-family: "Fira Code", "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
            font-size: 0.95em;
        }
        
        /* Analysis & Example Sections */
        .analysis {
            margin-top: 20px;
            padding: 15px;
            background: #fdfdfd;
            border: 1px dashed #ccc;
            border-radius: 8px;
        }
        .analysis h4 {
            color: #27ae60;
            margin-bottom: 10px;
        }
        .analysis ul { list-style-position: inside; padding-left: 10px; }
        .analysis li { margin-bottom: 8px; }
        .analysis code {
            background-color: #e8e8e8;
            color: #c0392b;
            padding: 2px 5px;
            border-radius: 4px;
        }

        /* Quiz Section */
        .quiz-section {
            margin-top: 25px;
            padding: 20px;
            background-color: #f5eef8;
            border: 1px solid #e8daef;
            border-radius: 8px;
        }
        .quiz-section h4 { color: #8e44ad; }
        .quiz-options div { margin: 10px 0; }
        .quiz-options label { margin-left: 8px; cursor: pointer; }
        .feedback {
            margin-top: 10px;
            font-weight: bold;
            padding: 8px;
            border-radius: 4px;
            display: none;
        }
        .feedback.correct { color: #27ae60; background-color: #e8f5e9; }
        .feedback.incorrect { color: #c0392b; background-color: #fbe9e7; }

        /* Buttons */
        .quiz-submit-btn, .unlock-btn {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            font-size: 1.05em;
            font-weight: bold;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .quiz-submit-btn { background-color: #9b59b6; }
        .quiz-submit-btn:hover { background-color: #8e44ad; }
        .unlock-btn { background: linear-gradient(90deg, #9b59b6, #8e44ad); }
        .unlock-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(142, 68, 173, 0.4); }
        .unlock-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="container">
        <h1>æœ€ç»ˆç« ï¼šæ•´åˆæ‰€æœ‰åŠŸèƒ½åˆ° `mian.py`</h1>
        <p class="intro">
            æ¬¢è¿æ¥åˆ°æœ€åçš„æŒ‘æˆ˜ï¼æˆ‘ä»¬å·²ç»åˆ¶ä½œå¥½äº†â€œè®°äº‹æœ¬â€ã€â€œæ•…äº‹å¤§ç‹â€ã€â€œéšæœºé­”æ³•â€å’Œâ€œçŸ¥è¯†åº“â€ç­‰å¼ºå¤§æ¨¡å—ã€‚ç°åœ¨ï¼Œæ˜¯æ—¶å€™æŠŠè¿™äº›é›¶ä»¶ç»„è£…èµ·æ¥ï¼Œè®©æˆ‘ä»¬çš„å°PåŠ©æ‰‹çœŸæ­£å˜å¾—å®Œæ•´å’Œå¼ºå¤§ï¼
        </p>

        <!-- Level 1: Robust Import -->
        <div id="level-1" class="level-card">
            <h2>å…³å¡ 1ï¼šå¼€å¯æ—¶ç©ºä¹‹é—¨ (å¥å£®çš„æ¨¡å—å¯¼å…¥)</h2>
            <p class="objective">å­¦ä¹ ç›®æ ‡ï¼šå­¦ä¼šä½¿ç”¨ `try...except ImportError` æ¥å®‰å…¨åœ°å¯¼å…¥æ¨¡å—ï¼Œå³ä½¿æŸä¸ªæ¨¡å—æ–‡ä»¶ä¸¢å¤±ï¼Œç¨‹åºä¹Ÿèƒ½ç»§ç»­è¿è¡Œè€Œä¸ä¼šå´©æºƒã€‚</p>
            
            <h3>åœ¨ `mian.py` ä¸­æ–°å¢çš„å¯¼å…¥ä»£ç </h3>
            <pre><code># æ–°å¢å¯¼å…¥
try:
    import random_magic.magic_handler
    magic_module_found = True
except ImportError:
    print("è­¦å‘Šï¼šæœªèƒ½æ‰¾åˆ° 'éšæœºé­”æ³•' æ¨¡å—...")
    magic_module_found = False

try:
    import local_kb.kb_handler
    kb_module_found = True
except ImportError:
    print("è­¦å‘Šï¼šæœªèƒ½æ‰¾åˆ° 'æœ¬åœ°çŸ¥è¯†åº“' æ¨¡å—...")
    kb_module_found = False</code></pre>

            <div class="analysis">
                <h4>ğŸ’¡ ä»£ç è§£è¯»</h4>
                <ul>
                    <li><code>try:</code> Pythonä¼šå°è¯•æ‰§è¡Œè¿™ä¸‹é¢çš„ä»£ç ã€‚</li>
                    <li><code>import random_magic.magic_handler</code>: è¿™å°±æ˜¯å¯¼å…¥æˆ‘ä»¬ä¹‹å‰å†™çš„æ¨¡å—ï¼å®ƒçš„æ„æ€æ˜¯â€œä» `random_magic` æ–‡ä»¶å¤¹ä¸­ï¼Œå¯¼å…¥ `magic_handler.py` æ–‡ä»¶â€ã€‚</li>
                    <li><code>magic_module_found = True</code>: å¦‚æœå¯¼å…¥æˆåŠŸï¼Œæˆ‘ä»¬å°±è®¾ç½®ä¸€ä¸ªâ€œæ ‡å¿—â€å˜é‡ä¸º `True`ï¼Œè¡¨ç¤ºè¿™ä¸ªåŠŸèƒ½å¯ç”¨ã€‚</li>
                    <li><code>except ImportError:</code> å¦‚æœ `try` å—ä¸­çš„å¯¼å…¥å¤±è´¥äº†ï¼ˆæ¯”å¦‚æ–‡ä»¶ä¸å­˜åœ¨æˆ–è·¯å¾„é”™è¯¯ï¼‰ï¼Œç¨‹åºä¸ä¼šå´©æºƒï¼Œè€Œæ˜¯ä¼šè·³è½¬åˆ°è¿™é‡Œæ¥æ‰§è¡Œã€‚</li>
                    <li><code>magic_module_found = False</code>: åœ¨å¯¼å…¥å¤±è´¥æ—¶ï¼Œæˆ‘ä»¬æŠŠæ ‡å¿—å˜é‡è®¾ä¸º `False`ã€‚</li>
                </ul>
            </div>
            
            <div class="quiz-section">
                <h4>ğŸ§  å°æµ‹éªŒ</h4>
                <p>ä½¿ç”¨ `try...except ImportError` ç»“æ„å¯¼å…¥æ¨¡å—ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ</p>
                <div class="quiz-options">
                    <div><input type="radio" id="q1a" name="quiz1" value="a"><label for="q1a">è®©æ¨¡å—åŠ è½½å¾—æ›´å¿«ã€‚</label></div>
                    <div><input type="radio" id="q1b" name="quiz1" value="b" data-correct="true"><label for="q1b">å³ä½¿æŸä¸ªæ¨¡å—æ–‡ä»¶ä¸¢å¤±ï¼Œä¸»ç¨‹åºä¹Ÿèƒ½ç»§ç»­è¿è¡Œï¼Œåªæ˜¯éƒ¨åˆ†åŠŸèƒ½ä¸å¯ç”¨ã€‚</label></div>
                    <div><input type="radio" id="q1c" name="quiz1" value="c"><label for="q1c">è‡ªåŠ¨ä¿®å¤ä¸¢å¤±çš„æ¨¡å—æ–‡ä»¶ã€‚</label></div>
                </div>
                <button class="quiz-submit-btn" data-level="1">æäº¤ç­”æ¡ˆ</button>
                <p class="feedback" id="feedback-1"></p>
            </div>
            
            <button class="unlock-btn" data-unlock="level-2" disabled>æˆ‘ç†è§£äº†ï¼Œä¸‹ä¸€å…³ï¼</button>
        </div>

        <!-- Level 2: Conditional Greeting -->
        <div id="level-2" class="level-card hidden">
            <h2>å…³å¡ 2ï¼šåŠ¨æ€åŠŸèƒ½èœå• (æ¡ä»¶åˆ¤æ–­)</h2>
            <p class="objective">å­¦ä¹ ç›®æ ‡ï¼šåˆ©ç”¨ä¸Šä¸€å…³è®¾ç½®çš„æ ‡å¿—ä½ï¼Œè®©å°Pçš„è‡ªæˆ‘ä»‹ç»èƒ½æ ¹æ®å½“å‰å¯ç”¨çš„åŠŸèƒ½åŠ¨æ€å˜åŒ–ã€‚</p>

            <h3>æ›´æ–°å°Pçš„è‡ªæˆ‘ä»‹ç»</h3>
            <pre><code># ...
if magic_module_found:
    print(f"è¾“å…¥ 'éšæœºé­”æ³•' æˆ– 'é­”æ³•' å¯ä»¥è®©æˆ‘å¸®ä½ åšé€‰æ‹©æˆ–ç©æ¸¸æˆã€‚")
if kb_module_found:
    print(f"è¾“å…¥ 'çŸ¥è¯†åº“' æˆ– 'é—®é—®é¢˜' å¯ä»¥è€ƒè€ƒæˆ‘çš„çŸ¥è¯†ï¼Œæˆ–è€…ç›´æ¥é—®æˆ‘é—®é¢˜ï¼")
# ...</code></pre>

            <div class="analysis">
                <h4>ğŸ’¡ ä»£ç è§£è¯»</h4>
                <ul>
                    <li><code>if magic_module_found:</code> è¿™è¡Œä»£ç çš„æ„æ€æ˜¯ï¼šâ€œå¦‚æœ `magic_module_found` è¿™ä¸ªæ ‡å¿—æ˜¯çœŸçš„ï¼ˆ`True`ï¼‰ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œä¸‹é¢çš„æ‰“å°è¯­å¥ã€‚â€</li>
                    <li>è¿™ç¡®ä¿äº†åªæœ‰å½“â€œéšæœºé­”æ³•â€æ¨¡å—æˆåŠŸå¯¼å…¥æ—¶ï¼Œå°Pæ‰ä¼šå‘Šè¯‰ç”¨æˆ·å®ƒæœ‰è¿™ä¸ªåŠŸèƒ½ã€‚å¦‚æœæ¨¡å—å¯¼å…¥å¤±è´¥ï¼ˆæ ‡å¿—ä¸º`False`ï¼‰ï¼Œè¿™æ¡ä»‹ç»å°±ä¸ä¼šæ˜¾ç¤ºã€‚</li>
                    <li>è¿™è®©æˆ‘ä»¬çš„ç¨‹åºå˜å¾—éå¸¸æ™ºèƒ½å’Œç”¨æˆ·å‹å¥½ï¼</li>
                </ul>
            </div>
            
            <div class="quiz-section">
                <h4>ğŸ§  å°æµ‹éªŒ</h4>
                <p>å¦‚æœåœ¨ä½ çš„é¡¹ç›®ä¸­ï¼Œä¸å°å¿ƒåˆ é™¤äº† `random_magic` æ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆå¯åŠ¨ `mian.py` åï¼Œå°Pçš„è‡ªæˆ‘ä»‹ç»ä¸­ä¼šåŒ…å«â€œè¾“å…¥ 'éšæœºé­”æ³•'...â€è¿™å¥è¯å—ï¼Ÿ</p>
                <div class="quiz-options">
                    <div><input type="radio" id="q2a" name="quiz2" value="a"><label for="q2a">ä¼šï¼Œå› ä¸ºä»£ç æ˜¯å†™æ­»çš„ã€‚</label></div>
                    <div><input type="radio" id="q2b" name="quiz2" value="b" data-correct="true"><label for="q2b">ä¸ä¼šï¼Œå› ä¸º `magic_module_found` ä¼šæ˜¯ `False`ï¼Œ`if` åˆ¤æ–­ä¸é€šè¿‡ã€‚</label></div>
                    <div><input type="radio" id="q2c" name="quiz2" value="c"><label for="q2c">ç¨‹åºä¼šç›´æ¥å´©æºƒï¼Œæ— æ³•è¿è¡Œã€‚</label></div>
                </div>
                <button class="quiz-submit-btn" data-level="2">æäº¤ç­”æ¡ˆ</button>
                <p class="feedback" id="feedback-2"></p>
            </div>
            
            <button class="unlock-btn" data-unlock="level-3" disabled>åŠ¨æ€èœå•ï¼ŒGetï¼</button>
        </div>
        
        <!-- Level 3: Function Integration -->
        <div id="level-3" class="level-card hidden">
            <h2>å…³å¡ 3ï¼šåŠŸèƒ½æ¥å…¥ä¸»å¾ªç¯ (`elif`)</h2>
            <p class="objective">å­¦ä¹ ç›®æ ‡ï¼šåœ¨ä¸»å¾ªç¯ä¸­æ·»åŠ æ–°çš„ `elif` åˆ†æ”¯ï¼Œä»¥ä¾¿åœ¨ç”¨æˆ·è¾“å…¥ç‰¹å®šå…³é”®è¯æ—¶ï¼Œèƒ½å¤Ÿæ­£ç¡®è°ƒç”¨ç›¸åº”æ¨¡å—ä¸­çš„å‡½æ•°ã€‚</p>
            
            <h3>åœ¨ä¸»å¾ªç¯ä¸­æ·»åŠ ä»£ç </h3>
            <pre><code># ...
elif ("éšæœºé­”æ³•" in user_input or "é­”æ³•" in user_input) and magic_module_found:
    print(f"å°Pï¼šå¥½çš„ï¼Œå‡†å¤‡å¥½è§è¯å¥‡è¿¹äº†å—ï¼Ÿ...")
    random_magic.magic_handler.run_random_magic_menu()

elif ("çŸ¥è¯†åº“" == user_input.lower() or "æ•™ä½ " in user_input) and kb_module_found:
    print(f"å°Pï¼šå¥½çš„ï¼Œæˆ‘ä»¬æ¥æ¢ç´¢ä¸€ä¸‹æˆ‘çš„çŸ¥è¯†åº“å§ï¼")
    local_kb.kb_handler.run_knowledge_menu()
# ...</code></pre>
            
            <div class="analysis">
                <h4>ğŸ’¡ ä»£ç è§£è¯»</h4>
                <ul>
                    <li><code>elif ("éšæœºé­”æ³•" in user_input ...):</code> æˆ‘ä»¬é€šè¿‡ `in` å…³é”®å­—æ£€æŸ¥ç”¨æˆ·çš„è¾“å…¥æ˜¯å¦åŒ…å«â€œéšæœºé­”æ³•â€æˆ–â€œé­”æ³•â€è¿™æ ·çš„å…³é”®è¯ã€‚</li>
                    <li><code>and magic_module_found</code>: å†æ¬¡ä½¿ç”¨æ ‡å¿—ä½ï¼Œç¡®ä¿åªæœ‰æ¨¡å—å­˜åœ¨æ—¶æ‰å°è¯•è°ƒç”¨ï¼Œè¿™æ˜¯åŒé‡ä¿é™©ï¼</li>
                    <li><code>random_magic.magic_handler.run_random_magic_menu()</code>: è¿™æ˜¯æœ€å…³é”®çš„è°ƒç”¨è¯­å¥ï¼å®ƒçš„ç»“æ„æ˜¯ **`æ–‡ä»¶å¤¹å.æ–‡ä»¶å.å‡½æ•°å()`**ã€‚è¿™å°±åƒåœ¨ç°å®ç”Ÿæ´»ä¸­å‘Šè¯‰æŸäººï¼šâ€œå»â€˜éšæœºé­”æ³•â€™è¿™ä¸ªéƒ¨é—¨ï¼Œæ‰¾â€˜é­”æ³•å¤„ç†å™¨â€™è¿™ä¸ªäººï¼Œè®©ä»–æ‰§è¡Œâ€˜è¿è¡Œé­”æ³•èœå•â€™è¿™ä¸ªä»»åŠ¡ã€‚â€</li>
                </ul>
            </div>
            
            <div class="quiz-section">
                <h4>ğŸ§  å°æµ‹éªŒ</h4>
                <p>å‡è®¾åœ¨ `local_kb` æ–‡ä»¶å¤¹çš„ `kb_handler.py` æ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªåä¸º `show_all()` çš„å‡½æ•°ï¼Œæ­£ç¡®çš„è°ƒç”¨æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ</p>
                <div class="quiz-options">
                    <div><input type="radio" id="q3a" name="quiz3" value="a"><label for="q3a"><code>show_all()</code></label></div>
                    <div><input type="radio" id="q3b" name="quiz3" value="b"><label for="q3b"><code>kb_handler.show_all()</code></label></div>
                    <div><input type="radio" id="q3c" name="quiz3" value="c" data-correct="true"><label for="q3c"><code>local_kb.kb_handler.show_all()</code></label></div>
                </div>
                <button class="quiz-submit-btn" data-level="3">æäº¤ç­”æ¡ˆ</button>
                <p class="feedback" id="feedback-3"></p>
            </div>

            <button class="unlock-btn" data-unlock="level-4" disabled>æ¨¡å—è°ƒç”¨ï¼Œå­¦ä¼šäº†ï¼</button>
        </div>
        
        <!-- Level 4: Smart Default -->
        <div id="level-4" class="level-card hidden">
            <h2>å…³å¡ 4ï¼šæ™ºèƒ½å¤§è„‘ (å¢å¼ºé»˜è®¤å›å¤)</h2>
            <p class="objective">å­¦ä¹ ç›®æ ‡ï¼šæ”¹é€ æœ€ç»ˆçš„ `else` æ¨¡å—ï¼Œè®©å°Påœ¨ä¸çŸ¥é“å¦‚ä½•å›ç­”æ—¶ï¼Œèƒ½å…ˆå»è‡ªå·±çš„â€œçŸ¥è¯†åº“â€é‡ŒæŸ¥ä¸€æŸ¥ï¼Œè€Œä¸æ˜¯ç«‹å³æ”¾å¼ƒã€‚</p>

            <h3>æ”¹é€  `else` é€»è¾‘</h3>
            <pre><code># ... (å‰é¢çš„eliféƒ½åˆ¤æ–­å®Œå)
else: # é»˜è®¤å›å¤é€»è¾‘
    found_answer = False
    # ... å…ˆæ£€æŸ¥ç®€å•å›å¤å’Œä½ å¥½
    
    # åœ¨ç»™å‡ºéšæœºå›å¤å‰ï¼Œå…ˆæŸ¥çŸ¥è¯†åº“ï¼
    if not found_answer and kb_module_found:
        kb_answer = local_kb.kb_handler.query_knowledge_base(user_input)
        if kb_answer:
            print(f"å°Pï¼š{kb_answer}")
            found_answer = True
    
    # å¦‚æœæ‰€æœ‰æ–¹æ³•éƒ½è¯•è¿‡äº†ï¼Œè¿˜æ˜¯æ²¡æ‰¾åˆ°ç­”æ¡ˆ
    if not found_answer:
        # ... æ‰ç»™å‡ºéšæœºçš„é»˜è®¤å›å¤
        print(f"å°Pï¼š{random.choice(default_responses)}")</code></pre>
        
            <div class="analysis">
                <h4>ğŸ’¡ ä»£ç è§£è¯»ï¼šè®©å°Pæ›´æ™ºèƒ½</h4>
                <p>è¿™éƒ¨åˆ†ä»£ç æ˜¯å°Pæ™ºèƒ½åŒ–çš„å…³é”®ä¸€æ­¥ã€‚å½“ç”¨æˆ·è¾“å…¥ä¸€ä¸ªä¸å±äºä»»ä½•å‘½ä»¤ï¼ˆå¦‚â€œè®°äº‹æœ¬â€ã€â€œè®²æ•…äº‹â€ï¼‰çš„æ™®é€šå¥å­æ—¶ï¼š</p>
                <ol>
                    <li>ç¨‹åºä¸å†ç«‹åˆ»è¯´â€œæˆ‘ä¸çŸ¥é“â€ã€‚</li>
                    <li>å®ƒä¼šå…ˆæŠŠç”¨æˆ·çš„è¿™å¥è¯ï¼Œä½œä¸ºé—®é¢˜ï¼Œä¼ é€’ç»™æˆ‘ä»¬çš„ `query_knowledge_base` å‡½æ•°ï¼Œå»çŸ¥è¯†åº“é‡Œæœç´¢ç­”æ¡ˆã€‚</li>
                    <li>**å¦‚æœ**åœ¨çŸ¥è¯†åº“é‡Œæ‰¾åˆ°äº†ç­”æ¡ˆ (`if kb_answer:`)ï¼Œå°±å›ç­”å®ƒã€‚</li>
                    <li>**åªæœ‰å½“**çŸ¥è¯†åº“é‡Œä¹Ÿæ‰¾ä¸åˆ°ç­”æ¡ˆæ—¶ (`if not found_answer:`)ï¼Œå®ƒæ‰ä¼šåƒä»¥å‰ä¸€æ ·ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªâ€œæˆ‘ä¸çŸ¥é“â€ç±»å‹çš„å›å¤ã€‚</li>
                </ol>
                <p>è¿™è®©å°Pçš„å¯¹è¯èƒ½åŠ›å¤§å¤§å¢å¼ºäº†ï¼</p>
            </div>

            <div class="quiz-section">
                <h4>ğŸ§  å°æµ‹éªŒ</h4>
                <p>æ ¹æ®ä¸Šé¢æ”¹é€ åçš„é€»è¾‘ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥äº†ä¸€ä¸ªå°Pä¸è®¤è¯†ï¼Œä½†çŸ¥è¯†åº“é‡Œæ°å¥½æœ‰ç­”æ¡ˆçš„é—®é¢˜ï¼Œå°Pä¼šæ€ä¹ˆåšï¼Ÿ</p>
                <div class="quiz-options">
                    <div><input type="radio" id="q4a" name="quiz4" value="a" data-correct="true"><label for="q4a">å›ç­”çŸ¥è¯†åº“é‡Œæ‰¾åˆ°çš„ç­”æ¡ˆã€‚</label></div>
                    <div><input type="radio" id="q4b" name="quiz4" value="b"><label for="q4b">å›ç­”â€œå—¯...ä½ è¯´çš„è¿™ä¸ªæˆ‘è¿˜åœ¨å­¦ä¹ ä¸­å‘¢ã€‚â€</label></div>
                    <div><input type="radio" id="q4c" name="quiz4" value="c"><label for="q4c">æç¤ºç”¨æˆ·è¾“å…¥â€œçŸ¥è¯†åº“â€æ¥æŸ¥è¯¢ã€‚</label></div>
                </div>
                <button class="quiz-submit-btn" data-level="4">æäº¤ç­”æ¡ˆ</button>
                <p class="feedback" id="feedback-4"></p>
            </div>

            <button class="unlock-btn" data-unlock="final-challenge" disabled>æˆ‘å·²å…¨éƒ¨é€šå…³ï¼æŸ¥çœ‹æœ€ç»ˆä»£ç ï¼</button>
        </div>

        <!-- Final Code -->
        <div id="final-challenge" class="level-card hidden">
            <h2>ğŸ† ç»ˆææŒ‘æˆ˜ï¼šå®Œæ•´çš„å°Pä¸»ç¨‹åº ğŸ†</h2>
            <p class="objective">å¤ªäº†ä¸èµ·äº†ï¼ä½ å·²ç»å®Œæˆäº†æ‰€æœ‰çš„æ•´åˆå·¥ä½œã€‚ç°åœ¨ï¼Œä½ çš„ `mian.py` æˆä¸ºäº†ä¸€ä¸ªçœŸæ­£çš„â€œæŒ‡æŒ¥ä¸­å¿ƒâ€ï¼Œèƒ½å¤Ÿè°ƒåº¦æ‰€æœ‰åŠŸèƒ½æ¨¡å—ã€‚ä¸‹é¢æ˜¯å®Œæ•´çš„ä»£ç ï¼Œå¤åˆ¶å®ƒï¼Œè¿è¡Œå®ƒï¼Œè§è¯ä½ äº²æ‰‹åˆ›é€ çš„ã€åŠŸèƒ½å®Œå¤‡çš„AIåŠ©æ‰‹â€”â€”å°Pï¼</p>
            <div style="position: relative;">
                <button id="copy-button" style="position: absolute; top: 15px; right: 15px; background-color: #9b59b6; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; opacity: 0.9; transition: all 0.3s ease;">ä¸€é”®å¤åˆ¶</button>
                <pre><code id="python-code"># mian.py
# creatorï¼šXianSong_Lin
# Time in 2025/6/5 15:27

# å¯¼å…¥æˆ‘ä»¬è‡ªå·±çš„æ¨¡å—
# æ³¨æ„ï¼šè¿™é‡Œçš„å¯¼å…¥è·¯å¾„æ˜¯åŸºäº mian.py åœ¨ XiaoP æ ¹ç›®å½•ï¼Œ
# å¹¶ä¸”æ¨¡å—æ–‡ä»¶å¤¹ä¹Ÿåœ¨ XiaoP æ ¹ç›®å½•ã€‚
try:
    # ä½ çš„ç°æœ‰å¯¼å…¥ï¼Œç¡®ä¿å®ƒä»¬èƒ½æ­£å¸¸å·¥ä½œ
    import å°Pçš„è¶…çº§è®°äº‹æœ¬.jishiben # å¦‚æœ jishiben.py åœ¨ XiaoP/å°Pçš„è¶…çº§è®°äº‹æœ¬/ ç›®å½•ä¸‹
    notepad_module_found = True
except ImportError:
    print("è­¦å‘Šï¼šæœªèƒ½æ‰¾åˆ° 'è®°äº‹æœ¬' æ¨¡å— (å°Pçš„è¶…çº§è®°äº‹æœ¬.jishiben)ã€‚")
    notepad_module_found = False

try:
    import å°Pæ˜¯æ•…äº‹å¤§ç‹.gushidawang as gushi # å¦‚æœ gushidawang.py åœ¨ XiaoP/å°Pæ˜¯æ•…äº‹å¤§ç‹/ ç›®å½•ä¸‹
    story_module_found = True
except ImportError:
    print("è­¦å‘Šï¼šæœªèƒ½æ‰¾åˆ° 'æ•…äº‹å¤§ç‹' æ¨¡å— (å°Pæ˜¯æ•…äº‹å¤§ç‹.gushidawang)ã€‚")
    story_module_found = False

# æ–°å¢å¯¼å…¥
try:
    import random_magic.magic_handler # ä» XiaoP/random_magic/ ç›®å½•å¯¼å…¥ magic_handler.py
    magic_module_found = True
except ImportError:
    print("è­¦å‘Šï¼šæœªèƒ½æ‰¾åˆ° 'éšæœºé­”æ³•' æ¨¡å— (random_magic.magic_handler)ã€‚è¯¥åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨ã€‚")
    magic_module_found = False

try:
    import local_kb.kb_handler # ä» XiaoP/local_kb/ ç›®å½•å¯¼å…¥ kb_handler.py
    kb_module_found = True
except ImportError:
    print("è­¦å‘Šï¼šæœªèƒ½æ‰¾åˆ° 'æœ¬åœ°çŸ¥è¯†åº“' æ¨¡å— (local_kb.kb_handler)ã€‚è¯¥åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨ã€‚")
    kb_module_found = False

# 1. ç»™æˆ‘ä»¬çš„å°Pèµ·ä¸ªåå­—
my_ai_name = "å°PåŠ©æ‰‹"

# 2. å°Påšè‡ªæˆ‘ä»‹ç» (æ›´æ–°)
print(f"ä½ å¥½ï¼æˆ‘æ˜¯{my_ai_name}ã€‚å¾ˆé«˜å…´è®¤è¯†ä½ ï¼")
print(f"ä½ å¯ä»¥å¯¹æˆ‘è¯´ 'ä½ å¥½'ã€‚")
if notepad_module_found:
    print(f"è¾“å…¥ 'è®°äº‹æœ¬' å¯ä»¥ä½¿ç”¨æˆ‘çš„è®°äº‹æœ¬åŠŸèƒ½ã€‚")
if story_module_found:
    print(f"è¾“å…¥ 'è®²æ•…äº‹' æˆ– 'å¹ç‰›' å¯ä»¥å¬æˆ‘è®²æ•…äº‹ã€‚")
if magic_module_found:
    print(f"è¾“å…¥ 'éšæœºé­”æ³•' æˆ– 'é­”æ³•' å¯ä»¥è®©æˆ‘å¸®ä½ åšé€‰æ‹©æˆ–ç©æ¸¸æˆã€‚")
if kb_module_found:
    print(f"è¾“å…¥ 'çŸ¥è¯†åº“' æˆ– 'é—®é—®é¢˜' å¯ä»¥è€ƒè€ƒæˆ‘çš„çŸ¥è¯†ï¼Œæˆ–è€…ç›´æ¥é—®æˆ‘é—®é¢˜ï¼")
print(f"è¾“å…¥ 'é€€å‡º' æˆ– 'å†è§' å°±å¯ä»¥ç»“æŸèŠå¤©ã€‚")


# 4. å‡†å¤‡ä¸€äº›å°Pèƒ½å¬æ‡‚çš„è¯å’Œå›ç­”
responses = {
    "ä½ å¥½å‘€": "ä½ å¥½ä½ å¥½ï¼ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼",
    "ä½ å«ä»€ä¹ˆåå­—": f"æˆ‘å«{my_ai_name}ï¼Œå¾ˆé«˜å…´ä¸ºä½ æœåŠ¡ï¼",
}

# 5. åˆ›å»ºä¸€ä¸ªä¸»å¾ªç¯
while True:
    user_input = input("\nä½ ï¼š").strip()

    if user_input.lower() in ["é€€å‡º", "å†è§", "bye", "exit"]:
        print(f"å°Pï¼šå¥½çš„ï¼Œä¸‹æ¬¡å†èŠï¼æ‹œæ‹œï¼")
        break

    elif "è®°äº‹æœ¬" in user_input and notepad_module_found:
        print(f"å°Pï¼šå¥½çš„ï¼Œæ­£åœ¨ä¸ºä½ æ‰“å¼€è®°äº‹æœ¬åŠŸèƒ½...")
        å°Pçš„è¶…çº§è®°äº‹æœ¬.jishiben.run_notepad() # æ³¨æ„è¿™é‡Œçš„è°ƒç”¨æ–¹å¼
        print(f"\nå°Pï¼šè®°äº‹æœ¬å·²å…³é—­ã€‚æˆ‘ä»¬ç»§ç»­èŠå¤©å§ï¼")
    
    elif ("å¹ç‰›" in user_input or "è®²æ•…äº‹" in user_input) and story_module_found:
        print(f"å°Pï¼šå¥½çš„ï¼Œå‡†å¤‡å¬æˆ‘å¤§æ˜¾èº«æ‰‹å§ï¼")
        gushi.tell_a_story() # æ³¨æ„è¿™é‡Œçš„è°ƒç”¨æ–¹å¼ (gushi æ˜¯ as gushi çš„åˆ«å)
        print(f"\nå°Pï¼šæ•…äº‹è®²å®Œå•¦ï¼æˆ‘ä»¬ç»§ç»­èŠå¤©å§ï¼")

    elif ("éšæœºé­”æ³•" in user_input or "é­”æ³•" in user_input) and magic_module_found:
        print(f"å°Pï¼šå¥½çš„ï¼Œå‡†å¤‡å¥½è§è¯å¥‡è¿¹äº†å—ï¼Ÿè¿›å…¥éšæœºé­”æ³•å±‹ï¼")
        random_magic.magic_handler.run_random_magic_menu() # è°ƒç”¨æ–°æ¨¡å—çš„å‡½æ•°
        print(f"\nå°Pï¼šé­”æ³•æ—¶é—´ç»“æŸã€‚æˆ‘ä»¬ç»§ç»­èŠå¤©å§ï¼")
    
    elif ("çŸ¥è¯†åº“" == user_input.lower() or "æ•™ä½ " in user_input or "é—®é—®é¢˜" in user_input and "çŸ¥è¯†åº“" not in user_input) and kb_module_found: # è°ƒæ•´äº†æ¡ä»¶ï¼Œå…è®¸â€œé—®é—®é¢˜â€ç›´æ¥è§¦å‘
        if "æ•™ä½ " in user_input or "çŸ¥è¯†åº“" == user_input.lower() : # ç‰¹å®šæŒ‡ä»¤è¿›å…¥çŸ¥è¯†åº“èœå•
            print(f"å°Pï¼šå¥½çš„ï¼Œæˆ‘ä»¬æ¥æ¢ç´¢ä¸€ä¸‹æˆ‘çš„çŸ¥è¯†åº“å§ï¼")
            local_kb.kb_handler.run_knowledge_menu()
            print(f"\nå°Pï¼šçŸ¥è¯†åº“äº’åŠ¨ç»“æŸã€‚è¿˜æœ‰å…¶ä»–æƒ³èŠçš„å—ï¼Ÿ")
        else: # ç›´æ¥é—®é—®é¢˜ï¼Œä¸è¿›å…¥èœå•
            kb_answer = local_kb.kb_handler.query_knowledge_base(user_input)
            if kb_answer:
                print(f"å°Pï¼š{kb_answer}")
            else:
                print("å°Pï¼šå—¯...æˆ‘å¯¹è¿™ä¸ªè¿˜ä¸å¤ªäº†è§£ã€‚ä½ å¯ä»¥è¯•è¯•é€šè¿‡è¾“å…¥â€œçŸ¥è¯†åº“â€ç„¶åé€‰æ‹©â€œæ•™å°Pâ€æ¥æ•™æˆ‘å“¦ï¼")

    else: # é»˜è®¤å›å¤é€»è¾‘
        found_answer = False
        if user_input.lower() in responses:
            print(f"å°Pï¼š{responses[user_input.lower()]}")
            found_answer = True
        elif "ä½ å¥½" in user_input.lower():
            print("å°Pï¼šä½ å¥½å‘€ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ï¼")
            found_answer = True
        
        if not found_answer and kb_module_found and "çŸ¥è¯†åº“" not in user_input and "æ•™ä½ " not in user_input: # é¿å…é‡å¤æŸ¥è¯¢
            kb_answer = local_kb.kb_handler.query_knowledge_base(user_input)
            if kb_answer:
                print(f"å°Pï¼š{kb_answer}")
                found_answer = True
        
        if not found_answer:
            # ç¡®ä¿ random æ¨¡å—å·²å¯¼å…¥
            import random 
            default_responses = [
                "å—¯...ä½ è¯´çš„è¿™ä¸ªæˆ‘è¿˜åœ¨å­¦ä¹ ä¸­å‘¢ã€‚",
                "è¿™ä¸ªé—®é¢˜æœ‰ç‚¹æ·±å¥¥ï¼Œæˆ‘å¾—å›å»æŸ¥æŸ¥ä¹¦ï¼",
                "ä½ å¯ä»¥è¯•è¯•é—®æˆ‘â€œä½ ä¼šåšä»€ä¹ˆâ€ï¼Œæˆ–è€…é€šè¿‡è¾“å…¥â€œçŸ¥è¯†åº“â€ç„¶åé€‰æ‹©â€œæ•™å°Pâ€æ¥æ•™æˆ‘ä¸€äº›æ–°ä¸œè¥¿å“¦ï¼",
                "æˆ‘å¯¹è¿™ä¸ªè¿˜ä¸å¤ªäº†è§£ï¼Œèƒ½æ¢ä¸ªè¯é¢˜å—ï¼Ÿ"
            ]
            print(f"å°Pï¼š{random.choice(default_responses)}")
</code></pre>
            </div>
        </div>

    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Quiz and Unlock Logic ---
        const quizButtons = document.querySelectorAll('.quiz-submit-btn');
        quizButtons.forEach(button => {
            button.addEventListener('click', () => {
                const level = button.dataset.level;
                const quizForm = button.closest('.quiz-section');
                const selectedOption = quizForm.querySelector(`input[name="quiz${level}"]:checked`);
                const feedbackEl = document.getElementById(`feedback-${level}`);
                
                if (!selectedOption) {
                    feedbackEl.textContent = "è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼";
                    feedbackEl.className = 'feedback incorrect';
                    feedbackEl.style.display = 'block';
                    return;
                }

                const isCorrect = selectedOption.hasAttribute('data-correct');
                if (isCorrect) {
                    feedbackEl.textContent = "å›ç­”æ­£ç¡®ï¼å¤ªæ£’äº†ï¼ğŸ‰";
                    feedbackEl.className = 'feedback correct';
                    
                    const levelCard = button.closest('.level-card');
                    const unlockButton = levelCard.querySelector('.unlock-btn');
                    unlockButton.disabled = false;
                    
                    quizForm.querySelectorAll('input, button').forEach(el => el.disabled = true);
                } else {
                    feedbackEl.textContent = "ç­”æ¡ˆä¸å¯¹å“¦ï¼Œå†æƒ³æƒ³ï¼ŸğŸ¤”";
                    feedbackEl.className = 'feedback incorrect';
                }
                feedbackEl.style.display = 'block';
            });
        });

        // --- Unlock Button Logic ---
        const unlockButtons = document.querySelectorAll('.unlock-btn');
        unlockButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                if (button.disabled) return;
                const targetId = button.getAttribute('data-unlock');
                const nextLevel = document.getElementById(targetId);

                if (nextLevel) {
                    nextLevel.classList.remove('hidden');
                    nextLevel.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    e.target.textContent = 'å·²å®Œæˆ âœ”ï¸';
                }
            });
        });

        // --- Copy Button Logic ---
        const copyButton = document.getElementById('copy-button');
        if (copyButton) {
            const codeBlock = document.getElementById('python-code');
            copyButton.addEventListener('click', () => {
                navigator.clipboard.writeText(codeBlock.innerText).then(() => {
                    copyButton.textContent = 'å·²å¤åˆ¶!';
                    copyButton.style.backgroundColor = '#2ecc71';
                    setTimeout(() => {
                        copyButton.textContent = 'ä¸€é”®å¤åˆ¶';
                        copyButton.style.backgroundColor = '#9b59b6';
                    }, 2000);
                });
            });
        }
    });
    </script>

</body>
</html>